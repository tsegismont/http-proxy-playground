= http-proxy-playground

== Running Postgres Locally

[source,shell]
----
docker run --name http-proxy-playground-postgres -p 5432:5432 -e POSTGRES_PASSWORD=mysecretpassword -d postgres
----

== Deploying to Minikube

Assuming `minikube` and `kubectl` are installed:

[source,shell]
----
minikube start
minikube addons enable dashboard
minikube addons enable metrics-server
eval $(minikube -p minikube docker-env)
mvn clean install jib:dockerBuild
kubectl apply -R -f k8s
----

When the service is ready:

[source,shell]
----
xdg-open $(minikube service edge-service --url --https)
----

== Query endpoints within a container

[source,shell]
----
curl -v --cacert /var/run/secrets/kubernetes.io/serviceaccount/ca.crt --header "Authorization: Bearer $(cat /var/run/secrets/kubernetes.io/serviceaccount/token)" "https://${KUBERNETES_SERVICE_HOST}:${KUBERNETES_SERVICE_PORT_HTTPS}/api/v1/namespaces/$(cat /var/run/secrets/kubernetes.io/serviceaccount/namespace)/endpoints"
----
